{% extends 'users/base.html' %}
{% load static %}

{% block content %}

<div class="d-flex" id="wrapper">

    {% include 'users/includes/sidebar.html' %}
    <div class="main-content" style="margin-left:250px; margin-top:70px; width:100%; transition:0.3s" id="main-content">

        <nav class="navbar navbar-expand-lg navbar-light bg-light" style="padding:15px 20px;">
            <div class="container-fluid">
                <h4 class="mb-0">Policy Holder Dashboard</h4>
            </div>
        </nav>

        <div class="container-fluid p-4">

            <div class="row mb-4">
                <div class="col-12">
                    <div class="alert alert-primary shadow-sm" role="alert">
                        <h5 class="alert-heading">Welcome back, {{ request.user.username }}!</h5>
                        <p class="mb-0">Your dashboard is the central hub for managing your health insurance policies.</p>
                    </div>
                </div>
            </div>

            <div class="row">

                <div class="col-md-6 col-lg-4 mb-4">
                    <div class="card text-white bg-success shadow-lg h-100 cursor-pointer" onclick="window.location.href='{% url 'policy:policy_management' %}'">
                        <div class="card-body">
                            <div class="d-flex justify-content-between align-items-center">
                                <div>
                                    <h5 class="card-title"><i class="fas fa-file-contract me-2"></i> Policy Management</h5>
                                    <p class="card-text">View available plans, apply for new policies, and check your current coverage.</p>
                                </div>
                                <i class="fas fa-arrow-circle-right fa-3x"></i>
                            </div>
                        </div>
                        <div class="card-footer bg-transparent border-0 text-end">
                            <a href="{% url 'policy:policy_management' %}" class="text-white small fw-bold">Manage Policies &rarr;</a>
                        </div>
                    </div>
                </div>
            <div class="row">
                <div class="col-12">
                    <div class="card shadow-sm">
                        <div class="card-header bg-light">
                            <h6 class="mb-0">Quick Status / Policy Alerts</h6>
                        </div>
                        <ul class="list-group list-group-flush">
                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                Active Policy Count:
                                <span class="badge bg-success rounded-pill">
                                    {{ active_policy_count|default:0 }}
                                </span>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

    </div>
</div>

<script>
// Sync content margin with sidebar collapse (Your existing JS)
document.addEventListener("DOMContentLoaded", function () {
    const sidebar = document.getElementById("sidebar");
    const mainContent = document.getElementById("main-content");

    const observer = new MutationObserver(() => {
        if (sidebar.classList.contains("collapsed")) {
            mainContent.style.marginLeft = "70px";
        } else {
            mainContent.style.marginLeft = "250px";
        }
    });

    observer.observe(sidebar, { attributes: true });
});
</script>

{% endblock %}